<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Computer Words: A system for writing and publishing documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="static/normalize.css" type="text/css" /><link rel="stylesheet" href="static/default.css" type="text/css" /><link rel="stylesheet" href="style.css" type="text/css" /><link rel="stylesheet" href="static/pygments.css" type="text/css" />
    </head>
    <body>
        <header id="pageheader">
            <a class="header-link" href="index.html"><h1>Computer Words</h1></a>
            <h2>A system for writing and publishing documentation</h2>
            <div id="navheader"><nav class='previous-page'><a href="about.html">&larr; Conceptual information</a></nav><nav class='next-page'><a href="roadmap.html">Missing features &amp; roadmap &rarr;</a></nav><div style="clear: both;"></div></div>
            <hr>
        </header>
        <main id="pagebody"><article><a href="#API" name="API" class='header-anchor'><h1>API</h1></a><p><section class='autodoc-module'><a href="#computerwords.cwdom.traversal" name="computerwords.cwdom.traversal" class='header-anchor'><h2><tt><span class='autodoc-identifier'>computerwords.cwdom.traversal</span></tt></h2></a><section class='autodoc-module-docstring-body'>Utilities for traversing <tt>CWNode</tt> trees.</section></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.preorder_traversal" name="computerwords.cwdom.traversal.preorder_traversal" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>preorder_traversal</span><span class='autodoc-arguments'>(node)</span><span class='autodoc-return-value'> &rarr; iterator(CWNode)</span></tt></h3></a><section class='autodoc-function-docstring-body'>Yields every node in the tree. Each node is yielded before its descendants. Mutation is disallowed.</section></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.postorder_traversal" name="computerwords.cwdom.traversal.postorder_traversal" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>postorder_traversal</span><span class='autodoc-arguments'>(node)</span><span class='autodoc-return-value'> &rarr; iterator(CWNode)</span></tt></h3></a><section class='autodoc-function-docstring-body'>Yields every node in the tree. Each node is yielded after its descendants. Mutation is disallowed.</section></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.iterate_ancestors" name="computerwords.cwdom.traversal.iterate_ancestors" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>iterate_ancestors</span><span class='autodoc-arguments'>(node)</span></tt></h3></a><section class='autodoc-function-docstring-body'><p>Yields every ancestor of a node, starting with its immediate parent.</p><figure class='code'><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">computerwords.cwdom.nodes</span> <span class="kn">import</span> <span class="n">CWNode</span>
<span class="kn">from</span> <span class="nn">computerwords.cwdom.traversal</span> <span class="kn">import</span> <span class="n">iterate_ancestors</span>
<span class="n">node_c</span> <span class="o">=</span> <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">node_c</span><span class="p">]),</span>
    <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="p">[]),</span>
<span class="p">])</span>
<span class="k">assert</span> <span class="p">([</span><span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">iterate_ancestors</span><span class="p">(</span><span class="n">node_c</span><span class="p">)]</span> <span class="o">==</span>
        <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
</pre></div>
</figure></section></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.find_ancestor" name="computerwords.cwdom.traversal.find_ancestor" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>find_ancestor</span><span class='autodoc-arguments'>(node, predicate)</span></tt></h3></a><section class='autodoc-function-docstring-body'><p>Returns the closest ancestor of a node matching the given predicate.</p><figure class='code'><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">computerwords.cwdom.traversal</span> <span class="kn">import</span> <span class="n">find_ancestor</span>
<span class="n">document_node</span> <span class="o">=</span> <span class="n">find_ancestor</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Document&#39;</span><span class="p">)</span>
</pre></div>
</figure></section></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.visit_tree" name="computerwords.cwdom.traversal.visit_tree" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>visit_tree</span><span class='autodoc-arguments'>(tree, node_name_to_visitor, node=None)</span></tt></h3></a><section class='autodoc-function-docstring-body'><p>Recursively call the <tt>CWTreeVisitor</tt> for each node. If a node is encountered that has no corresponding visitor, <tt>MissingVisitorError</tt> is thrown.</p><figure class='code'><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">computerwords.cwdom.CWTree</span> <span class="kn">import</span> <span class="n">CWTree</span>
<span class="kn">from</span> <span class="nn">computerwords.cwdom.traversal</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">visit_tree</span><span class="p">,</span>
    <span class="n">CWTreeVisitor</span>
<span class="p">)</span>

<span class="n">visits</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">class</span> <span class="nc">SimpleVisitor</span><span class="p">(</span><span class="n">CWTreeVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">visits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pre-{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">after_children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">visits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;post-{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">CWTree</span><span class="p">(</span><span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">[])]))</span>
<span class="n">visit_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">SimpleVisitor</span><span class="p">(),</span>
    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">SimpleVisitor</span><span class="p">(),</span>
<span class="p">})</span>
<span class="k">assert</span> <span class="n">visits</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;pre-x&#39;</span><span class="p">,</span> <span class="s1">&#39;pre-y&#39;</span><span class="p">,</span> <span class="s1">&#39;post-y&#39;</span><span class="p">,</span> <span class="s1">&#39;post-x&#39;</span><span class="p">]</span>
</pre></div>
</figure></section></section><section class='autodoc-class'><a href="#computerwords.cwdom.traversal.MissingVisitorError" name="computerwords.cwdom.traversal.MissingVisitorError" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>MissingVisitorError</span><span class='autodoc-arguments'>(Exception)</span></tt></h3></a><section class='autodoc-class-docstring-body'>Error thrown when trying to visit a node for which no visitor is available.</section></section><section class='autodoc-class'><a href="#computerwords.cwdom.traversal.CWTreeVisitor" name="computerwords.cwdom.traversal.CWTreeVisitor" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWTreeVisitor</span><span class='autodoc-arguments'>()</span></tt></h3></a></section><section class='autodoc-method'><a href="#computerwords.cwdom.traversal.CWTreeVisitor.before_children" name="computerwords.cwdom.traversal.CWTreeVisitor.before_children" class='header-anchor'><h4><tt><span class='autodoc-identifier'>before_children</span><span class='autodoc-arguments'>(tree, node)</span></tt></h4></a><section class='autodoc-method-docstring-body'>Called before the node&#x27;s children are visited.</section></section><section class='autodoc-method'><a href="#computerwords.cwdom.traversal.CWTreeVisitor.after_children" name="computerwords.cwdom.traversal.CWTreeVisitor.after_children" class='header-anchor'><h4><tt><span class='autodoc-identifier'>after_children</span><span class='autodoc-arguments'>(tree, node)</span></tt></h4></a><section class='autodoc-method-docstring-body'>Called after the node&#x27;s children are visited.</section></section><section class='autodoc-class'><a href="#computerwords.cwdom.traversal.PostorderTraverser" name="computerwords.cwdom.traversal.PostorderTraverser" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>PostorderTraverser</span><span class='autodoc-arguments'>()</span></tt></h3></a><section class='autodoc-class-docstring-body'><p>A class that lets you iterate over a tree while mutating it.</p><p>Keeps track of a <i>cursor</i> representing the last visited node. Each time the next node is requested, the iterator looks at the cursor and walks up the tree to find the cursor&#x27;s next sibling or parent.</p><p>You may replace the cursor if you want to replace the node currently being visited.</p><p>You may safely mutate the cursor&#x27;s ancestors, since they haven&#x27;t been visited yet.</p></section></section><section class='autodoc-method'><a href="#computerwords.cwdom.traversal.PostorderTraverser.__init__" name="computerwords.cwdom.traversal.PostorderTraverser.__init__" class='header-anchor'><h4><tt><span class='autodoc-identifier'>__init__</span><span class='autodoc-arguments'>(node)</span></tt></h4></a></section><section class='autodoc-method'><a href="#computerwords.cwdom.traversal.PostorderTraverser.replace_cursor" name="computerwords.cwdom.traversal.PostorderTraverser.replace_cursor" class='header-anchor'><h4><tt><span class='autodoc-identifier'>replace_cursor</span><span class='autodoc-arguments'>(new_cursor)</span></tt></h4></a><section class='autodoc-method-docstring-body'>Only use this if you really know what you are doing.</section></section></p></article></main>
        <footer id="pagefooter"><nav class='previous-page'><a href="about.html">&larr; Conceptual information</a></nav><nav class='next-page'><a href="roadmap.html">Missing features &amp; roadmap &rarr;</a></nav><div style="clear: both;"></div></footer>
    </body>
</html>
