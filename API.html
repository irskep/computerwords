<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Computer Words: API</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="static/normalize.css" type="text/css" /><link rel="stylesheet" href="static/default.css" type="text/css" /><link rel="stylesheet" href="style.css" type="text/css" /><link rel="stylesheet" href="static/pygments.css" type="text/css" />
    </head>
    <body>
        <header id="pageheader">
            <a class="header-link" href="index.html"><h1>Computer Words</h1></a>
            <h2>A system for writing and publishing documentation</h2>
            <div id="navheader"><nav class='previous-page'><a href="about.html">&larr; Conceptual information</a></nav><nav class='next-page'><a href="roadmap.html">Missing features &amp; roadmap &rarr;</a></nav><div style="clear: both;"></div></div>
            <hr>
        </header>
        <main id="pagebody"><article><a href="#API" name="API" class='header-anchor'><h1>API</h1></a><p><section class='autodoc-module'><a href="#computerwords.cwdom.CWTree" name="computerwords.cwdom.CWTree" class='header-anchor'><h2><tt><span class='autodoc-identifier'>computerwords.cwdom.CWTree</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html' class='autodoc-source-link'>src</a></h2></a></section><section class='autodoc-class'><a href="#computerwords.cwdom.CWTree.CWTree" name="computerwords.cwdom.CWTree.CWTree" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWTree</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#16' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>The <tt>CWTree</tt> class models the tree of all documents and their contents. It allows you to traverse the tree in various ways and mutate it during some types of traversal.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.__init__" name="computerwords.cwdom.CWTree.CWTree.__init__" class='header-anchor'><h4><tt><span class='autodoc-identifier'>__init__</span><span class='autodoc-arguments'>(root, env=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#23' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><ul><li><p><tt>root</tt>: Root of the tree</p></li><li><p><tt>env</tt>: Dictionary containing information about how Computer Words was invoked and configured</p></li></ul></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.preorder_traversal" name="computerwords.cwdom.CWTree.CWTree.preorder_traversal" class='header-anchor'><h4><tt><span class='autodoc-identifier'>preorder_traversal</span><span class='autodoc-arguments'>(node=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#43' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Shortcut for <tt>computerwords.cwdom.traversal.preorder_traversal()</tt> using the root</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.postorder_traversal" name="computerwords.cwdom.CWTree.CWTree.postorder_traversal" class='header-anchor'><h4><tt><span class='autodoc-identifier'>postorder_traversal</span><span class='autodoc-arguments'>(node=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#48' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Shortcut for <tt>computerwords.cwdom.traversal.postorder_traversal()</tt> using the root</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.postorder_traversal_allowing_ancestor_mutations" name="computerwords.cwdom.CWTree.CWTree.postorder_traversal_allowing_ancestor_mutations" class='header-anchor'><h4><tt><span class='autodoc-identifier'>postorder_traversal_allowing_ancestor_mutations</span><span class='autodoc-arguments'>(node=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#53' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><p>Yields every node in the tree in post-order.</p><p>While iterating, you use the mutation methods on this class to mutate the tree.</p></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.apply_library" name="computerwords.cwdom.CWTree.CWTree.apply_library" class='header-anchor'><h4><tt><span class='autodoc-identifier'>apply_library</span><span class='autodoc-arguments'>(library, initial_data=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#116' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Run the processing algorithm on the tree using <tt>library</tt>. Technically public, but you probably have no use for this.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.mark_node_dirty" name="computerwords.cwdom.CWTree.CWTree.mark_node_dirty" class='header-anchor'><h4><tt><span class='autodoc-identifier'>mark_node_dirty</span><span class='autodoc-arguments'>(node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#134' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Ensure this node&#x27;s processors are run at some point in the future.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.mark_ancestors_dirty" name="computerwords.cwdom.CWTree.CWTree.mark_ancestors_dirty" class='header-anchor'><h4><tt><span class='autodoc-identifier'>mark_ancestors_dirty</span><span class='autodoc-arguments'>(node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#140' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Ensure this node&#x27;s ancestors&#x27; processors are run at some point in the future.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.get_is_node_dirty" name="computerwords.cwdom.CWTree.CWTree.get_is_node_dirty" class='header-anchor'><h4><tt><span class='autodoc-identifier'>get_is_node_dirty</span><span class='autodoc-arguments'>(node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#153' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Returns <tt>True</tt> if the node is marked dirty.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.get_was_node_removed" name="computerwords.cwdom.CWTree.CWTree.get_was_node_removed" class='header-anchor'><h4><tt><span class='autodoc-identifier'>get_was_node_removed</span><span class='autodoc-arguments'>(node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#157' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Returns <tt>True</tt> if the node was previously in the tree but has since been removed.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.wrap_node" name="computerwords.cwdom.CWTree.CWTree.wrap_node" class='header-anchor'><h4><tt><span class='autodoc-identifier'>wrap_node</span><span class='autodoc-arguments'>(inner_node, outer_node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#177' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><p>Add an ancestor between <tt>inner_node</tt> and its parent.</p><figure class='image graphviz-graph'><img src='feb95ae60ec9dc2b9f2054b152def6ee02df61c511aee72c4cdf08f3e997d2c8.svg'></img></figure><figure class='code'><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">wrap_node</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">))</span>
</pre></div>
</figure><figure class='image graphviz-graph'><img src='9581f7438580520edaff9d5e4c1bdd1faca73ed1854f842e91954b93f3180e86.svg'></img></figure><p><strong>Limitations</strong></p><ul><li><p><tt>outer_node</tt> may not have any existing children.</p></li></ul></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.replace_subtree" name="computerwords.cwdom.CWTree.CWTree.replace_subtree" class='header-anchor'><h4><tt><span class='autodoc-identifier'>replace_subtree</span><span class='autodoc-arguments'>(old_node, new_node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#211' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><p>Replace a node and all its children with another node and all its children.</p><figure class='image graphviz-graph'><img src='eb349db133af6094e63197705feadfbdb464cd24d2faed4f9ddd4fdd84b019cb.svg'></img></figure><figure class='code'><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">replace_subtree</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">),</span>
    <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">),</span>
<span class="p">]))</span>
</pre></div>
</figure><figure class='image graphviz-graph'><img src='f6833bbc0eb65e22486661e526c67db9ccabb0951cae32631b0e7de6f52bbf90.svg'></img></figure></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.insert_subtree" name="computerwords.cwdom.CWTree.CWTree.insert_subtree" class='header-anchor'><h4><tt><span class='autodoc-identifier'>insert_subtree</span><span class='autodoc-arguments'>(parent, i, child)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#249' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><p>Adds a note <tt>child</tt> and all its children as a child of <tt>parent</tt> at index <tt>i</tt>.</p><figure class='image graphviz-graph'><img src='2fc4981467d23324ad13f36eb2e8e1075c46265923480a6b2497ae05942d577e.svg'></img></figure><figure class='code'><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">insert_subtree</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
</pre></div>
</figure><figure class='image graphviz-graph'><img src='eee4b481b66a377a45c91c4fed163d7c76854680a33dd92e8fa93a710526bcdb.svg'></img></figure><p><strong>Limitations</strong> (may be temporary)</p><ul><li><p><tt>parent</tt> must be the active node or a descendant of it.</p></li></ul></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.add_siblings_ahead" name="computerwords.cwdom.CWTree.CWTree.add_siblings_ahead" class='header-anchor'><h4><tt><span class='autodoc-identifier'>add_siblings_ahead</span><span class='autodoc-arguments'>(new_siblings)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#280' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><p>Add <tt>new_siblings</tt> as children of the active node&#x27;s parent immediately after the active node.</p><p>This may be replaced by a more general method later.</p><figure class='image graphviz-graph'><img src='8c7032bc43c0ad71f5c822d085c7e62a59208c998e32e5bee373e345e39e5ee6.svg'></img></figure><figure class='code'><div class="highlight"><pre><span></span><span class="nd">@library.processor</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_b</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">add_siblings_ahead</span><span class="p">([</span><span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)])</span>
</pre></div>
</figure><figure class='image graphviz-graph'><img src='90f2d5737e3bf0695e72f1418c2eb61ece3f3981ed91d2c702795090ee12c81c.svg'></img></figure></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.replace_node" name="computerwords.cwdom.CWTree.CWTree.replace_node" class='header-anchor'><h4><tt><span class='autodoc-identifier'>replace_node</span><span class='autodoc-arguments'>(old_node, new_node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#311' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><p>Replace <tt>old_node</tt> with <tt>new_node</tt>. Give all of <tt>old_node</tt>&#x27;s children to <tt>new_node</tt>.</p><figure class='image graphviz-graph'><img src='d9ce16e3d774a2c20424f2957afa2fb565a25c5c3c60815630a83bd7bf10e3b7.svg'></img></figure><figure class='code'><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">replace_node</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
</pre></div>
</figure><figure class='image graphviz-graph'><img src='7ffc751d2d4411b7c8319de295c8ffaa3dec57806e59e457654b8e7921aca5e7.svg'></img></figure><p><strong>Limitations</strong> (may be temporary)</p><ul><li><p>May only be used on the active node.</p></li></ul></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.get_is_descendant" name="computerwords.cwdom.CWTree.CWTree.get_is_descendant" class='header-anchor'><h4><tt><span class='autodoc-identifier'>get_is_descendant</span><span class='autodoc-arguments'>(maybe_descendant, maybe_ancestor)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#346' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Returns <tt>True</tt> if <tt>maybe_descendant</tt> is a descendant of <tt>maybe_ancestor</tt>.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.text_to_ref_id" name="computerwords.cwdom.CWTree.CWTree.text_to_ref_id" class='header-anchor'><h4><tt><span class='autodoc-identifier'>text_to_ref_id</span><span class='autodoc-arguments'>(text)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#357' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Returns a ref_id that is unique against all other ref_ids returned by this function, vaguely resembling <tt>text</tt></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.CWTree.CWTree.subtree_to_text" name="computerwords.cwdom.CWTree.CWTree.subtree_to_text" class='header-anchor'><h4><tt><span class='autodoc-identifier'>subtree_to_text</span><span class='autodoc-arguments'>(node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#371' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Returns a string of the concatenated text in a subtree</div></section><section class='autodoc-class'><a href="#computerwords.cwdom.CWTree.CWTreeConsistencyError" name="computerwords.cwdom.CWTree.CWTreeConsistencyError" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWTreeConsistencyError</span><span class='autodoc-arguments'>(Exception)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/CWTree.py.html#380' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>Error that is thrown if any of the limitations of <tt>CWTree</tt>&#x27;s methods are violated</div></section></p><p><section class='autodoc-module'><a href="#computerwords.cwdom.traversal" name="computerwords.cwdom.traversal" class='header-anchor'><h2><tt><span class='autodoc-identifier'>computerwords.cwdom.traversal</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html' class='autodoc-source-link'>src</a></h2></a><div class='autodoc-module-docstring-body'>Utilities for traversing <tt>CWNode</tt> trees.</div></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.preorder_traversal" name="computerwords.cwdom.traversal.preorder_traversal" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>preorder_traversal</span><span class='autodoc-arguments'>(node)</span><span class='autodoc-return-value'> &rarr; iterator(CWNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html#8' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-function-docstring-body'>Yields every node in the tree. Each node is yielded before its descendants. Mutation is disallowed.</div></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.postorder_traversal" name="computerwords.cwdom.traversal.postorder_traversal" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>postorder_traversal</span><span class='autodoc-arguments'>(node)</span><span class='autodoc-return-value'> &rarr; iterator(CWNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html#20' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-function-docstring-body'>Yields every node in the tree. Each node is yielded after its descendants. Mutation is disallowed.</div></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.iterate_ancestors" name="computerwords.cwdom.traversal.iterate_ancestors" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>iterate_ancestors</span><span class='autodoc-arguments'>(node)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html#37' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-function-docstring-body'><p>Yields every ancestor of a node, starting with its immediate parent.</p><figure class='code'><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">computerwords.cwdom.nodes</span> <span class="kn">import</span> <span class="n">CWNode</span>
<span class="kn">from</span> <span class="nn">computerwords.cwdom.traversal</span> <span class="kn">import</span> <span class="n">iterate_ancestors</span>
<span class="n">node_c</span> <span class="o">=</span> <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">node_c</span><span class="p">]),</span>
    <span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="p">[]),</span>
<span class="p">])</span>
<span class="k">assert</span> <span class="p">([</span><span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">iterate_ancestors</span><span class="p">(</span><span class="n">node_c</span><span class="p">)]</span> <span class="o">==</span>
        <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
</pre></div>
</figure></div></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.find_ancestor" name="computerwords.cwdom.traversal.find_ancestor" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>find_ancestor</span><span class='autodoc-arguments'>(node, predicate)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html#59' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-function-docstring-body'><p>Returns the closest ancestor of a node matching the given predicate.</p><figure class='code'><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">computerwords.cwdom.traversal</span> <span class="kn">import</span> <span class="n">find_ancestor</span>
<span class="n">document_node</span> <span class="o">=</span> <span class="n">find_ancestor</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Document&#39;</span><span class="p">)</span>
</pre></div>
</figure></div></section><section class='autodoc-function'><a href="#computerwords.cwdom.traversal.visit_tree" name="computerwords.cwdom.traversal.visit_tree" class='header-anchor'><h3><tt><span class='autodoc-keyword'>function </span><span class='autodoc-identifier'>visit_tree</span><span class='autodoc-arguments'>(tree, node_name_to_visitor, node=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html#73' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-function-docstring-body'><p>Recursively call the <tt>CWTreeVisitor</tt> for each node. If a node is encountered that has no corresponding visitor, <tt>MissingVisitorError</tt> is thrown.</p><figure class='code'><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">computerwords.cwdom.CWTree</span> <span class="kn">import</span> <span class="n">CWTree</span>
<span class="kn">from</span> <span class="nn">computerwords.cwdom.traversal</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">visit_tree</span><span class="p">,</span>
    <span class="n">CWTreeVisitor</span>
<span class="p">)</span>

<span class="n">visits</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">class</span> <span class="nc">SimpleVisitor</span><span class="p">(</span><span class="n">CWTreeVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">visits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pre-{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">after_children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">visits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;post-{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">CWTree</span><span class="p">(</span><span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">CWNode</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">[])]))</span>
<span class="n">visit_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">SimpleVisitor</span><span class="p">(),</span>
    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">SimpleVisitor</span><span class="p">(),</span>
<span class="p">})</span>
<span class="k">assert</span> <span class="n">visits</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;pre-x&#39;</span><span class="p">,</span> <span class="s1">&#39;pre-y&#39;</span><span class="p">,</span> <span class="s1">&#39;post-y&#39;</span><span class="p">,</span> <span class="s1">&#39;post-x&#39;</span><span class="p">]</span>
</pre></div>
</figure></div></section><section class='autodoc-class'><a href="#computerwords.cwdom.traversal.MissingVisitorError" name="computerwords.cwdom.traversal.MissingVisitorError" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>MissingVisitorError</span><span class='autodoc-arguments'>(Exception)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html#114' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>Error thrown when trying to visit a node for which no visitor is available.</div></section><section class='autodoc-class'><a href="#computerwords.cwdom.traversal.PostorderTraverser" name="computerwords.cwdom.traversal.PostorderTraverser" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>PostorderTraverser</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html#128' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'><p>A class that lets you iterate over a tree while mutating it.</p><p>Keeps track of a <i>cursor</i> representing the last visited node. Each time the next node is requested, the iterator looks at the cursor and walks up the tree to find the cursor&#x27;s next sibling or parent.</p><p>You may replace the cursor if you want to replace the node currently being visited.</p><p>You may safely mutate the cursor&#x27;s ancestors, since they haven&#x27;t been visited yet.</p></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.traversal.PostorderTraverser.replace_cursor" name="computerwords.cwdom.traversal.PostorderTraverser.replace_cursor" class='header-anchor'><h4><tt><span class='autodoc-identifier'>replace_cursor</span><span class='autodoc-arguments'>(new_cursor)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/traversal.py.html#148' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Only use this if you really know what you are doing.</div></section></p><p><section class='autodoc-module'><a href="#computerwords.cwdom.nodes" name="computerwords.cwdom.nodes" class='header-anchor'><h2><tt><span class='autodoc-identifier'>computerwords.cwdom.nodes</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html' class='autodoc-source-link'>src</a></h2></a><div class='autodoc-module-docstring-body'><p>This module contains the nodes that make up the document tree.</p><h3>Vocabulary</h3><ul><li><p><strong>Document ID, <tt>document_id</tt>, or <tt>doc_id</tt></strong>: a tuple of strings representing a document&#x27;s relative path to the root of the source files. For example, <tt>(&#x27;api&#x27;, &#x27;index.md&#x27;)</tt>.</p></li></ul></div></section><section class='autodoc-class'><a href="#computerwords.cwdom.nodes.CWNode" name="computerwords.cwdom.nodes.CWNode" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWNode</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#31' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>Superclass for all nodes. Unless you&#x27;re writing test cases, you&#x27;ll generally be dealing with subclasses of this.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.__init__" name="computerwords.cwdom.nodes.CWNode.__init__" class='header-anchor'><h4><tt><span class='autodoc-identifier'>__init__</span><span class='autodoc-arguments'>(name, children=None, document_id=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#35' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><ul><li><p><tt>name</tt>: aka type or kind of node</p></li><li><p><tt>children</tt>: list of initial children</p></li><li><p><tt>document_id</tt>: document ID of the document in which this node resides. Usually assigned after initialization by <tt>CWTree</tt>.</p></li></ul></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.claim_children" name="computerwords.cwdom.nodes.CWNode.claim_children" class='header-anchor'><h4><tt><span class='autodoc-identifier'>claim_children</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#58' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Call <tt>child.set_parent(self)</tt> on each child</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.set_children" name="computerwords.cwdom.nodes.CWNode.set_children" class='header-anchor'><h4><tt><span class='autodoc-identifier'>set_children</span><span class='autodoc-arguments'>(children)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#63' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Replace <tt>self.children</tt> with a new list of children, and set their parent values</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.get_parent" name="computerwords.cwdom.nodes.CWNode.get_parent" class='header-anchor'><h4><tt><span class='autodoc-identifier'>get_parent</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#70' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Return this node&#x27;s current parent, or <tt>None</tt> if there isn&#x27;t one</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.set_parent" name="computerwords.cwdom.nodes.CWNode.set_parent" class='header-anchor'><h4><tt><span class='autodoc-identifier'>set_parent</span><span class='autodoc-arguments'>(new_parent)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#77' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Set this node&#x27;s parent</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.deep_set_document_id" name="computerwords.cwdom.nodes.CWNode.deep_set_document_id" class='header-anchor'><h4><tt><span class='autodoc-identifier'>deep_set_document_id</span><span class='autodoc-arguments'>(new_id)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#84' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Set the <tt>document_id</tt> of this node and all its children</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.copy" name="computerwords.cwdom.nodes.CWNode.copy" class='header-anchor'><h4><tt><span class='autodoc-identifier'>copy</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#90' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Copy this node <i>but not its children</i></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.deepcopy" name="computerwords.cwdom.nodes.CWNode.deepcopy" class='header-anchor'><h4><tt><span class='autodoc-identifier'>deepcopy</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#94' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Copy this node <i>and its children</i></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.deepcopy_children_from" name="computerwords.cwdom.nodes.CWNode.deepcopy_children_from" class='header-anchor'><h4><tt><span class='autodoc-identifier'>deepcopy_children_from</span><span class='autodoc-arguments'>(node, at_end=False)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#100' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Add a deep copy of all <tt>node</tt>&#x27;s descendants before or after existing children</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.get_string_for_test_comparison" name="computerwords.cwdom.nodes.CWNode.get_string_for_test_comparison" class='header-anchor'><h4><tt><span class='autodoc-identifier'>get_string_for_test_comparison</span><span class='autodoc-arguments'>(inner_indentation=2)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#109' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Returns a string that is very convenient to compare using <tt>unittest.TestCase.assertMultiLineEqual()</tt></div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.get_args_string_for_test_comparison" name="computerwords.cwdom.nodes.CWNode.get_args_string_for_test_comparison" class='header-anchor'><h4><tt><span class='autodoc-identifier'>get_args_string_for_test_comparison</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#125' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Subclasses may override this to populate arguments in test strings</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWNode.shallow_repr" name="computerwords.cwdom.nodes.CWNode.shallow_repr" class='header-anchor'><h4><tt><span class='autodoc-identifier'>shallow_repr</span><span class='autodoc-arguments'>()</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#133' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'>Like <tt>self.__repr__()</tt>, but don&#x27;t include children</div></section><section class='autodoc-class'><a href="#computerwords.cwdom.nodes.CWRootNode" name="computerwords.cwdom.nodes.CWRootNode" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWRootNode</span><span class='autodoc-arguments'>(CWNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#144' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>The node at the root of a <tt>CWTree</tt>. Its immediate children should all be instances of <tt>CWDocumentNode</tt>.</div></section><section class='autodoc-class'><a href="#computerwords.cwdom.nodes.CWDocumentNode" name="computerwords.cwdom.nodes.CWDocumentNode" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWDocumentNode</span><span class='autodoc-arguments'>(CWNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#158' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>A node representing a document. Its descendants can be anything but <tt>CWRootNode</tt> and <tt>CWDocumentNode</tt>.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWDocumentNode.__init__" name="computerwords.cwdom.nodes.CWDocumentNode.__init__" class='header-anchor'><h4><tt><span class='autodoc-identifier'>__init__</span><span class='autodoc-arguments'>(path, children=None, document_id=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#162' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><ul><li><p><tt>path</tt>: Filesystem path to this document</p></li></ul></div></section><section class='autodoc-class'><a href="#computerwords.cwdom.nodes.CWTagNode" name="computerwords.cwdom.nodes.CWTagNode" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWTagNode</span><span class='autodoc-arguments'>(CWNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#183' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>A node that can be directly converted to valid HTML.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWTagNode.__init__" name="computerwords.cwdom.nodes.CWTagNode.__init__" class='header-anchor'><h4><tt><span class='autodoc-identifier'>__init__</span><span class='autodoc-arguments'>(name, kwargs, children=None, document_id=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#186' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><ul><li><p><tt>name</tt>: Still the type/kind of node, but is also a valid HTML tag name.</p></li><li><p><tt>kwargs</tt>: Arguments/attributes parsed from the tag or inserted by processors.</p></li></ul></div></section><section class='autodoc-class'><a href="#computerwords.cwdom.nodes.CWTextNode" name="computerwords.cwdom.nodes.CWTextNode" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWTextNode</span><span class='autodoc-arguments'>(CWNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#223' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>A node that only contains text to be written to output.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWTextNode.__init__" name="computerwords.cwdom.nodes.CWTextNode.__init__" class='header-anchor'><h4><tt><span class='autodoc-identifier'>__init__</span><span class='autodoc-arguments'>(text, document_id=None, escape=True)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#226' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><ul><li><p><tt>text</tt>: The text</p></li><li><p><tt>escape</tt>: If <tt>True</tt>, output should be escaped in whatever the output language is. Defaults to <tt>True</tt>.</p></li></ul></div></section><section class='autodoc-class'><a href="#computerwords.cwdom.nodes.CWAnchorNode" name="computerwords.cwdom.nodes.CWAnchorNode" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWAnchorNode</span><span class='autodoc-arguments'>(CWTagNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#250' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>A node that can be linked to via its globally unique <tt>ref_id</tt>. Essentially a specialized version of <tt>CWTagNode(&#x27;a&#x27;, {&#x27;name&#x27;: ...})</tt>.</div></section><section class='autodoc-method'><a href="#computerwords.cwdom.nodes.CWAnchorNode.__init__" name="computerwords.cwdom.nodes.CWAnchorNode.__init__" class='header-anchor'><h4><tt><span class='autodoc-identifier'>__init__</span><span class='autodoc-arguments'>(ref_id, kwargs=None, children=None, document_id=None)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#256' class='autodoc-source-link'>src</a></h4></a><div class='autodoc-method-docstring-body'><ul><li><p><tt>ref_id</tt>: Globally unique ID of this anchor</p></li></ul></div></section><section class='autodoc-class'><a href="#computerwords.cwdom.nodes.CWLinkNode" name="computerwords.cwdom.nodes.CWLinkNode" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWLinkNode</span><span class='autodoc-arguments'>(CWNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#280' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'><p>A node that can link to the location of a <tt>CWAnchorNode</tt> to via its globally unique <tt>ref_id</tt>.</p><p>In the future, this may become a subclass of <tt>CWTagNode</tt>.</p></div></section><section class='autodoc-class'><a href="#computerwords.cwdom.nodes.CWDocumentLinkNode" name="computerwords.cwdom.nodes.CWDocumentLinkNode" class='header-anchor'><h3><tt><span class='autodoc-keyword'>class </span><span class='autodoc-identifier'>CWDocumentLinkNode</span><span class='autodoc-arguments'>(CWNode)</span></tt><a href='http://steveasleep.com/computerwords/src/computerwords/cwdom/nodes.py.html#306' class='autodoc-source-link'>src</a></h3></a><div class='autodoc-class-docstring-body'>A node that can link to the location of a document without including any anchors inside the page.</div></section></p></article></main>
        <footer id="pagefooter"><nav class='previous-page'><a href="about.html">&larr; Conceptual information</a></nav><nav class='next-page'><a href="roadmap.html">Missing features &amp; roadmap &rarr;</a></nav><div style="clear: both;"></div></footer>
    </body>
</html>
